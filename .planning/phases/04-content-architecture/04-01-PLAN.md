---
phase: 04-content-architecture
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - bambini-fussball/src/content.config.ts
  - bambini-fussball/src/components/Header.astro
  - bambini-fussball/src/layouts/BaseLayout.astro
autonomous: true

must_haves:
  truths:
    - "Content collections use Astro 5 glob() loader syntax"
    - "Navigation menu is visible on every page"
    - "Navigation provides links to /trainer/, /eltern/, /vereine/"
  artifacts:
    - path: "bambini-fussball/src/content.config.ts"
      provides: "Astro 5 content collections with glob() loaders"
      contains: "glob({ pattern"
    - path: "bambini-fussball/src/components/Header.astro"
      provides: "Navigation component with category links"
      min_lines: 15
    - path: "bambini-fussball/src/layouts/BaseLayout.astro"
      provides: "Base layout with Header component"
      contains: "Header"
  key_links:
    - from: "bambini-fussball/src/layouts/BaseLayout.astro"
      to: "bambini-fussball/src/components/Header.astro"
      via: "import and render"
      pattern: "import Header"
---

<objective>
Migrate content configuration to Astro 5 syntax and create site-wide navigation.

Purpose: Establish foundation for content collections and provide users access to all three target audience categories from any page.

Output: Working content API with glob() loaders, Header navigation component, updated BaseLayout with Header.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-content-architecture/04-RESEARCH.md

Key patterns from research:
- Use glob() loader instead of type: 'content'
- Use z.coerce.date() for YAML date parsing
- Touch targets min-h-[44px] inline-flex items-center
- Trailing slashes required (Astro config has trailingSlash: 'always')
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate content.config.ts to Astro 5 glob() loader</name>
  <files>bambini-fussball/src/content.config.ts</files>
  <action>
Update the existing content.config.ts to use Astro 5 Content Layer API:

1. Add import for glob from 'astro/loaders'
2. Replace `type: 'content'` with `loader: glob({ pattern: '**/*.md', base: './src/content/[collection]' })` for each collection
3. Change z.date() to z.coerce.date() for pubDate (YAML dates come as strings)
4. Change z.date().optional() to z.coerce.date().optional() for updatedDate

Final structure should match:
```typescript
import { defineCollection, z } from 'astro:content';
import { glob } from 'astro/loaders';

const articleSchema = z.object({
  title: z.string(),
  description: z.string(),
  pubDate: z.coerce.date(),
  updatedDate: z.coerce.date().optional(),
  author: z.string().default('Redaktion'),
});

const trainer = defineCollection({
  loader: glob({ pattern: '**/*.md', base: './src/content/trainer' }),
  schema: articleSchema,
});

const eltern = defineCollection({
  loader: glob({ pattern: '**/*.md', base: './src/content/eltern' }),
  schema: articleSchema,
});

const vereine = defineCollection({
  loader: glob({ pattern: '**/*.md', base: './src/content/vereine' }),
  schema: articleSchema,
});

export const collections = { trainer, eltern, vereine };
```

WHY: Legacy `type: 'content'` without loader will fail in Astro 5. The glob() loader is the new standard.
  </action>
  <verify>Run `npm run build` in bambini-fussball directory - should complete without content collection errors</verify>
  <done>content.config.ts uses glob() loaders and z.coerce.date() for all collections</done>
</task>

<task type="auto">
  <name>Task 2: Create Header navigation and integrate into BaseLayout</name>
  <files>bambini-fussball/src/components/Header.astro, bambini-fussball/src/layouts/BaseLayout.astro</files>
  <action>
Create Header.astro navigation component:

1. Create bambini-fussball/src/components/Header.astro with:
   - Logo/site name linking to home (/)
   - Three navigation links: Trainer (/trainer/), Eltern (/eltern/), Vereine (/vereine/)
   - Mobile-friendly layout (flex-col on small, flex-row on md+)
   - Touch-friendly targets: min-h-[44px] inline-flex items-center pattern
   - Color-coded hover states matching homepage cards (green for Trainer, blue for Eltern, amber for Vereine)
   - aria-label="Hauptnavigation" on nav element

Structure:
```astro
---
// src/components/Header.astro
---

<header class="bg-white border-b border-gray-200">
  <nav class="container mx-auto px-4 py-4" aria-label="Hauptnavigation">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <a href="/" class="text-xl font-bold text-green-700 hover:text-green-800">
        Bambini-Fussball
      </a>
      <ul class="flex flex-wrap gap-2 md:gap-6">
        <li>
          <a href="/trainer/" class="min-h-[44px] inline-flex items-center px-3 py-2 text-gray-700 hover:text-green-700 hover:bg-green-50 rounded-lg font-medium">
            Trainer
          </a>
        </li>
        <li>
          <a href="/eltern/" class="min-h-[44px] inline-flex items-center px-3 py-2 text-gray-700 hover:text-blue-700 hover:bg-blue-50 rounded-lg font-medium">
            Eltern
          </a>
        </li>
        <li>
          <a href="/vereine/" class="min-h-[44px] inline-flex items-center px-3 py-2 text-gray-700 hover:text-amber-700 hover:bg-amber-50 rounded-lg font-medium">
            Vereine
          </a>
        </li>
      </ul>
    </div>
  </nav>
</header>
```

2. Update BaseLayout.astro:
   - Import Header component
   - Add Header between body opening tag and slot
   - Wrap slot in main with flex-1 for proper footer positioning

WHY: Navigation must be site-wide (CONT-02 requirement). BaseLayout is used by all pages.
  </action>
  <verify>Run `npm run dev` and verify Header appears on homepage with three category links visible</verify>
  <done>Header.astro created with three category links, BaseLayout updated to render Header on all pages</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Header navigation visible on homepage
3. All three category links present: Trainer, Eltern, Vereine
4. Links have correct href attributes with trailing slashes
</verification>

<success_criteria>
- content.config.ts uses glob() loader syntax (not legacy type: 'content')
- Header component exists with Trainer, Eltern, Vereine navigation links
- BaseLayout includes Header component
- Navigation is accessible (aria-label present)
- Touch targets are 44px minimum height
</success_criteria>

<output>
After completion, create `.planning/phases/04-content-architecture/04-01-SUMMARY.md`
</output>
