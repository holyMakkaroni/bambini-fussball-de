---
phase: 10-performance-optimization
plan: 02
type: execute
wave: 2
depends_on: [10-01]
files_modified:
  - src/pages/trainer/[id].astro
  - src/pages/eltern/[id].astro
  - src/pages/vereine/[id].astro
autonomous: true

must_haves:
  truths:
    - "Category pages pass image and imageAlt to ArticleLayout"
    - "Image data flows from content collection to layout component"
  artifacts:
    - path: "src/pages/trainer/[id].astro"
      provides: "Image prop passing to ArticleLayout"
      contains: "image={article.data.image}"
    - path: "src/pages/eltern/[id].astro"
      provides: "Image prop passing to ArticleLayout"
      contains: "image={article.data.image}"
    - path: "src/pages/vereine/[id].astro"
      provides: "Image prop passing to ArticleLayout"
      contains: "image={article.data.image}"
  key_links:
    - from: "src/pages/*/[id].astro"
      to: "src/layouts/ArticleLayout.astro"
      via: "image and imageAlt props"
      pattern: "image=\\{article\\.data\\.image\\}"
---

<objective>
Wire image data from content collections through category pages to ArticleLayout.

Purpose: Complete the data flow so featured images render on article pages.

Output: All category article pages pass image and imageAlt props to ArticleLayout.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/10-performance-optimization/10-RESEARCH.md
@src/pages/trainer/[id].astro
@src/pages/eltern/[id].astro
@src/pages/vereine/[id].astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update category article pages to pass image props</name>
  <files>src/pages/trainer/[id].astro, src/pages/eltern/[id].astro, src/pages/vereine/[id].astro</files>
  <action>
Update all three category article pages to pass image and imageAlt to ArticleLayout.

For each file (trainer/[id].astro, eltern/[id].astro, vereine/[id].astro):

1. The article data is already destructured from `article.data`
2. Add `image` and `imageAlt` to the ArticleLayout component props:

Before:
```astro
<ArticleLayout
  title={article.data.title}
  description={article.data.description}
  category="trainer"
  pubDate={article.data.pubDate}
  updatedDate={article.data.updatedDate}
  authorId={author.id}
  authorName={author.data.name}
  articleId={article.id}
>
```

After:
```astro
<ArticleLayout
  title={article.data.title}
  description={article.data.description}
  category="trainer"
  pubDate={article.data.pubDate}
  updatedDate={article.data.updatedDate}
  authorId={author.id}
  authorName={author.data.name}
  articleId={article.id}
  image={article.data.image}
  imageAlt={article.data.imageAlt}
>
```

Repeat for all three category pages (trainer, eltern, vereine), adjusting the category prop accordingly.

The image prop will be ImageMetadata | undefined due to the optional schema field. ArticleLayout already handles undefined with conditional rendering.
  </action>
  <verify>Run `npm run build` - build succeeds; all 36+ pages generated without errors</verify>
  <done>All category article pages pass image and imageAlt to ArticleLayout; data flow complete from content to component</done>
</task>

<task type="auto">
  <name>Task 2: Verify image optimization pipeline end-to-end</name>
  <files>None (verification only)</files>
  <action>
Verify the complete image optimization pipeline is wired correctly:

1. Run development server: `npm run dev`
2. Run production build: `npm run build`
3. Check build output for:
   - No errors or warnings about image processing
   - Pages generate successfully

4. Inspect the build output directory (dist/) to confirm:
   - Image assets would be processed if present
   - HTML output has correct Image component markup

5. Document that the pipeline is ready:
   - Schema uses image() helper (converts to ImageMetadata)
   - Components use `<Image />` (processes images at build time)
   - Config has layout: 'constrained' (responsive srcset automatic)
   - Priority set on hero images (eager loading for LCP)
   - Default lazy loading on thumbnails (below-fold images)

Note: Since existing articles don't have images defined in frontmatter, no actual image processing occurs yet. The pipeline is ready for when images are added.
  </action>
  <verify>
Run these commands and confirm success:
```bash
npm run build
# Expect: Build completes, 36+ pages generated

npm run preview
# Start preview server, spot-check a few article pages
```
  </verify>
  <done>Image optimization pipeline verified; ready for images to be added to content; build succeeds</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Full build verification:
   ```bash
   npm run build
   ```
   - Build completes successfully
   - All article pages generated (trainer, eltern, vereine)
   - No TypeScript or Astro errors

2. Data flow verification:
   - Category pages pass image prop to ArticleLayout
   - Conditional rendering handles undefined images gracefully

3. Pipeline readiness:
   - Schema: image() helper configured
   - Components: Image component imported and used
   - Config: layout and responsiveStyles enabled
   - Hero: priority attribute for LCP
   - Thumbnails: default lazy loading
</verification>

<success_criteria>
- All 3 category article pages pass image and imageAlt props
- Build succeeds with no errors
- Existing articles (without images) render correctly
- Pipeline ready for images when added to content frontmatter
</success_criteria>

<output>
After completion, create `.planning/phases/10-performance-optimization/10-02-SUMMARY.md`
</output>
