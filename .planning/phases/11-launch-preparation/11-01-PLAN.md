---
phase: 11-launch-preparation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - bambini-fussball/astro.config.mjs
  - bambini-fussball/package.json
  - bambini-fussball/public/robots.txt
autonomous: true

must_haves:
  truths:
    - "XML sitemap is auto-generated on build"
    - "Sitemap includes all pages (index, categories, articles, legal, about, author)"
    - "robots.txt allows search engine crawling"
    - "robots.txt references sitemap location"
  artifacts:
    - path: "bambini-fussball/public/robots.txt"
      provides: "Search engine crawling directives"
      contains: "Sitemap:"
    - path: "bambini-fussball/astro.config.mjs"
      provides: "Sitemap integration configuration"
      contains: "@astrojs/sitemap"
  key_links:
    - from: "astro.config.mjs"
      to: "dist/sitemap-index.xml"
      via: "sitemap integration"
      pattern: "sitemap\\(\\)"
    - from: "public/robots.txt"
      to: "/sitemap-index.xml"
      via: "Sitemap directive"
      pattern: "Sitemap:.*sitemap"
---

<objective>
Add XML sitemap generation and robots.txt for search engine indexing.

Purpose: Enable search engines (Google, Bing) to discover and index all pages correctly.
Output: Auto-generated sitemap on build, static robots.txt with crawling directives.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Astro config for integration setup
@bambini-fussball/astro.config.mjs
@bambini-fussball/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and configure @astrojs/sitemap integration</name>
  <files>bambini-fussball/package.json, bambini-fussball/astro.config.mjs</files>
  <action>
1. Install @astrojs/sitemap package:
   ```bash
   cd bambini-fussball && npm install @astrojs/sitemap
   ```

2. Update astro.config.mjs:
   - Import sitemap from '@astrojs/sitemap'
   - Add sitemap() to integrations array (after cookieconsent)
   - Add site property: 'https://bambini-fussball.pages.dev'

   The site property is REQUIRED for sitemap generation. Without it, Astro cannot generate absolute URLs.

3. Sitemap will auto-generate sitemap-index.xml and sitemap-0.xml on build containing:
   - / (homepage)
   - /trainer/, /eltern/, /vereine/ (category pages)
   - All article pages under each category
   - /impressum/, /datenschutz/ (legal pages)
   - /ueber-uns/ (about page)
   - /autor/[id]/ (author pages)
  </action>
  <verify>
Run `cd bambini-fussball && npm run build` - output should show sitemap generation.
Check dist/sitemap-index.xml exists and references sitemap-0.xml.
Check dist/sitemap-0.xml contains URLs for all pages.
  </verify>
  <done>Build produces sitemap-index.xml with all page URLs using production domain</done>
</task>

<task type="auto">
  <name>Task 2: Create robots.txt with sitemap reference</name>
  <files>bambini-fussball/public/robots.txt</files>
  <action>
Create public/robots.txt with:
```
User-agent: *
Allow: /

Sitemap: https://bambini-fussball.pages.dev/sitemap-index.xml
```

Notes:
- Allow all crawlers (User-agent: *)
- Permit full site crawling (Allow: /)
- Reference sitemap with full production URL
- Astro copies public/ files directly to dist/ on build
  </action>
  <verify>
After build, check dist/robots.txt exists and contains Sitemap directive.
Verify Sitemap URL matches production domain.
  </verify>
  <done>robots.txt exists at /robots.txt with crawling allowed and sitemap referenced</done>
</task>

</tasks>

<verification>
1. Run `npm run build` in bambini-fussball directory
2. Verify dist/sitemap-index.xml exists
3. Verify dist/sitemap-0.xml contains all expected URLs (grep for key pages)
4. Verify dist/robots.txt exists with correct content
5. Optionally run `npm run preview` and test /sitemap-index.xml and /robots.txt are accessible
</verification>

<success_criteria>
- TECH-03 MET: XML sitemap auto-generated with all pages
- TECH-04 MET: robots.txt configured with Allow and Sitemap directives
- Build completes without errors
- Sitemap contains 30+ URLs (homepage + 3 categories + ~28 articles + legal + about + author)
</success_criteria>

<output>
After completion, create `.planning/phases/11-launch-preparation/11-01-SUMMARY.md`
</output>
