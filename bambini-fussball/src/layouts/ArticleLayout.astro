---
// src/layouts/ArticleLayout.astro
import BaseLayout from './BaseLayout.astro';
import { Breadcrumbs } from 'astro-breadcrumbs';
import 'astro-breadcrumbs/breadcrumbs.css';

interface Props {
  title: string;
  description: string;
  category: 'trainer' | 'eltern' | 'vereine';
  pubDate: Date;
  updatedDate?: Date;
  authorId: string;
  authorName: string;
  image?: string;
}

const { title, description, category, pubDate, updatedDate, authorId, authorName, image } = Astro.props;

// Category labels in German
const categoryLabels = {
  trainer: 'Trainer',
  eltern: 'Eltern',
  vereine: 'Vereine'
};

// Custom breadcrumb items for semantic clarity
const crumbs = [
  { text: 'Startseite', href: '/' },
  { text: categoryLabels[category], href: `/${category}/` },
  { text: title, href: '#', 'aria-current': 'page' as const }
];

// Article JSON-LD schema for SEO
const siteUrl = 'https://bambini-fussball.pages.dev';
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": title,
  "description": description,
  "image": image ? `${siteUrl}${image}` : `${siteUrl}/images/og-default.jpg`,
  "datePublished": pubDate.toISOString(),
  "dateModified": (updatedDate || pubDate).toISOString(),
  "author": {
    "@type": "Person",
    "@id": `${siteUrl}/autor/${authorId}/`,
    "name": authorName,
    "url": `${siteUrl}/autor/${authorId}/`
  },
  "publisher": {
    "@type": "Organization",
    "name": "Bambini-Fussball",
    "url": siteUrl
  }
};
---

<BaseLayout title={`${title} | Bambini-Fussball`} description={description} type="article" image={image}>
  <script slot="head" type="application/ld+json" set:html={JSON.stringify(articleSchema)} />
  <main class="flex-1 container mx-auto px-4 py-8">
    <nav class="mb-6" aria-label="Breadcrumb">
      <Breadcrumbs
        crumbs={crumbs}
        indexText="Startseite"
        schemaJsonScript={true}
      />
    </nav>

    <article class="prose prose-lg max-w-3xl mx-auto">
      <header class="mb-8 not-prose">
        <h1 class="text-3xl font-bold text-gray-900 mb-4">{title}</h1>
        <div class="flex items-center gap-4 text-sm text-gray-600">
          <span>Von <a href={`/autor/${authorId}/`} class="text-green-700 hover:underline">{authorName}</a></span>
          <span aria-hidden="true">|</span>
          <time datetime={pubDate.toISOString()}>
            {pubDate.toLocaleDateString('de-DE', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
        </div>
      </header>

      <div class="article-content">
        <slot />
      </div>
    </article>
  </main>
</BaseLayout>

<style is:global>
  /* Breadcrumb styling to match site design */
  .c-breadcrumbs {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: 0.875rem;
  }

  .c-breadcrumbs__crumb {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .c-breadcrumbs__link {
    color: #4b5563;
    text-decoration: none;
  }

  .c-breadcrumbs__link:hover {
    color: #15803d;
    text-decoration: underline;
  }

  .c-breadcrumbs__link--current {
    color: #6b7280;
    pointer-events: none;
  }

  .c-breadcrumbs__separator {
    color: #9ca3af;
  }

  /* Article prose styling */
  .article-content h2 {
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-size: 1.5rem;
    font-weight: 600;
    color: #111827;
  }

  .article-content h3 {
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    font-size: 1.25rem;
    font-weight: 600;
    color: #1f2937;
  }

  .article-content p {
    margin-bottom: 1rem;
    line-height: 1.75;
    color: #374151;
  }

  .article-content ul, .article-content ol {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
  }

  .article-content li {
    margin-bottom: 0.5rem;
  }
</style>
